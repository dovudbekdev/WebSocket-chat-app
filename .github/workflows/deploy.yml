name: Deploy

on:
    push:
        branches: [main]

jobs:
    Deploy:
      runs-on: ubuntu-latest
      steps:
        - name: SSH-Keyni sozlash
          run: |
            mkdir -p ~/.ssh
            chmod 700 ~/.ssh
            echo "${{secrets.SSH_PRIVATE_KEY}}" > ~/.ssh/id_rsa
            touch ~/.ssh/known_hosts
            ssh-keyscan -H ${{vars.HOST}} > ~/.ssh/known_hosts
            chmod 600 ~/.ssh/known_hosts
            cat ~/.ssh/known_hosts
            
        - name: Serverga ulanish
          run: ssh ${{vars.USER}}@${{vars.HOST}}